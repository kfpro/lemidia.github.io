---
title:  "SPFA(Shortest Path Faster Algorithm)"
excerpt: "단일 출발 정점 모든 도착 정점 최단 경로 알고리즘"
toc: true
toc_sticky: true
# toc_label: "페이지 주요 목차"

categories:
 - Algorithm

tags:
  - Graph
  - Shortest Path
  - Queue
  - Search Algorithm
  
last_modified_at: 2019-05-10T08:06:00-05:00

header:
  overlay_image: /assets/images/headerLogo2.jpg
  overlay_filter: 0.3 # same as adding an opacity of 0.5 to a black background
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
  #actions:
  #  - label: "More Info"
  #    url: "https://unsplash.com"

use_math: true
---

# SPFA

The Shortest Path Faster Algorithm (SPFA) is an improvement of the Bellman–Ford algorithm which computes single-source shortest paths in a weighted directed graph. The algorithm is believed to work well on random sparse graphs and is particularly suitable for graphs that contain negative-weight edges.[1] However, the worst-case complexity of SPFA is the same as that of Bellman–Ford, so for graphs with nonnegative edge weights Dijkstra's algorithm is preferred. The SPFA algorithm was first published by Edward F. Moore in 1959, as a generalization of breadth first search;[2] the same algorithm was rediscovered in 1994 by Fanding Duan.[3]

## Algorithm

Given a weighted directed graph {\displaystyle G=(V,E)}{\displaystyle G=(V,E)} and a source vertex {\displaystyle s}s, the SPFA algorithm finds the shortest path from {\displaystyle s}s, to each vertex {\displaystyle v}v, in the graph. The length of the shortest path from {\displaystyle s}s, to {\displaystyle v}v is stored in {\displaystyle d(v)}{\displaystyle d(v)} for each vertex {\displaystyle v}v.

The basic idea of SPFA is the same as Bellman–Ford algorithm in that each vertex is used as a candidate to relax its adjacent vertices. The improvement over the latter is that instead of trying all vertices blindly, SPFA maintains a queue of candidate vertices and adds a vertex to the queue only if that vertex is relaxed. This process repeats until no more vertex can be relaxed.

Below is the pseudo-code of the algorithm.[4] Here {\displaystyle Q}Q is a first-in, first-out queue of candidate vertices, and {\displaystyle w(u,v)}{\displaystyle w(u,v)} is the edge weight of {\displaystyle (u,v)}(u,v).

```c++
 0 procedure Shortest-Path-Faster-Algorithm(G, s)
 1    for each vertex v ≠ s in V(G)
 2        d(v) := ∞
 3    d(s) := 0
 4    offer s into Q
 5    while Q is not empty
 6        u := poll Q
 7        for each edge (u, v) in E(G)
 8            if d(u) + w(u, v) < d(v) then
 9                d(v) := d(u) + w(u, v)
10                if v is not in Q then
11                    offer v into Q
```

The basic idea of SPFA is the same as Bellman–Ford algorithm in that each vertex is used as a candidate to relax its adjacent vertices. The improvement over the latter is that instead of trying all vertices blindly, SPFA maintains a queue of candidate vertices and adds a vertex to the queue only if that vertex is relaxed. This process repeats until no more vertex can be relaxed.

![Alt text](/assets/images/SPFA-0.png){: width="400px" height="300px" .align-center}

The performance of the algorithm is strongly determined by the order in which candidate vertices are used to relax other vertices. In fact, if {\displaystyle Q}Q is a priority queue, then the algorith

![Alt text](/assets/images/SPFA-1.png){: width="400px" height="300px" .align-center}

(and does not have to be in the queue anymore). However, the relaxation by {\displaystyle x}x might cause some other vertices to become capable of causing rel

![Alt text](/assets/images/SPFA-2.png){: width="400px" height="300px" .align-center}

axation. If there exists some {\displaystyle dist[x]>dist[w]+wt(w,x)}{\displaystyle dist[x]>dist[w]+wt(w,x)} such that before the current loop iteration, then {\displaystyle w}w is already in the queue. If this condition 

![Alt text](/assets/images/SPFA-3.png){: width="400px" height="300px" .align-center}

![Alt text](/assets/images/SPFA-4.png){: width="400px" height="300px" .align-center}

![Alt text](/assets/images/SPFA-5.png){: width="400px" height="300px" .align-center}

![Alt text](/assets/images/SPFA-6.png){: width="400px" height="300px" .align-center}

![Alt text](/assets/images/SPFA-7.png){: width="400px" height="300px" .align-center}

![Alt text](/assets/images/SPFA-8.png){: width="400px" height="300px" .align-center}

![Alt text](/assets/images/SPFA-9.png){: width="400px" height="300px" .align-center}

![Alt text](/assets/images/SPFA-10.png){: width="400px" height="300px" .align-center}

![Alt text](/assets/images/SPFA-11.png){: width="400px" height="300px" .align-center}

